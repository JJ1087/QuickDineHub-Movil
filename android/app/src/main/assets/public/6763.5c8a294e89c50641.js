"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6763],{6763:(F,p,d)=>{d.r(p),d.d(p,{Tab3PageModule:()=>y});var g=d(4742),m=d(177),b=d(4341),v=d(1307),f=d(691),c=d(467),e=d(3953),l=d(1626),h=d(8254);let x=(()=>{var t;class a{constructor(r){this.http=r,this.apiUrl="https://quickdinehub-back1.onrender.com"}obtenerOrdenes(){var r=this;return(0,c.A)(function*(){const{value:o}=yield h.p.get({key:"userId"}),{value:n}=yield h.p.get({key:"authToken"}),i=new l.Lr({Authorization:`Bearer ${n}`});return console.log("ID PAYASO:",o),r.http.get(`${r.apiUrl}/obtener-ordenes/${o}`,{headers:i})})()}obtenerDetalleOrdenes(){var r=this;return(0,c.A)(function*(){const{value:o}=yield h.p.get({key:"authToken"}),n=new l.Lr({Authorization:`Bearer ${o}`});return r.http.get(`${r.apiUrl}/info-detalleOrden`,{headers:n})})()}obtenerInfoDeOrdenPorId(r){const o=new l.Lr({Authorization:`Bearer ${localStorage.getItem("authToken")}`});return this.http.get(`${this.apiUrl}/info-ordenId/${r}`,{headers:o})}obtenerRestaurante(r){const o=new l.Lr({Authorization:`Bearer ${localStorage.getItem("authToken")}`});return this.http.get(`${this.apiUrl}/info-restauranteId/${r}`,{headers:o})}obtenerInfoDeProductosPorIds(r){const o=new l.Lr({Authorization:`Bearer ${localStorage.getItem("authToken")}`});return this.http.post(`${this.apiUrl}/info-productosIds`,{ids:r},{headers:o})}}return(t=a).\u0275fac=function(r){return new(r||t)(e.KVO(l.Qq))},t.\u0275prov=e.jDH({token:t,factory:t.\u0275fac,providedIn:"root"}),a})();function O(t,a){if(1&t&&(e.j41(0,"div",17),e.nrm(1,"img",18),e.j41(2,"div")(3,"p",19),e.EFF(4),e.k0s(),e.j41(5,"p",20),e.EFF(6),e.k0s(),e.j41(7,"p",20),e.EFF(8),e.k0s()()()),2&t){const s=a.$implicit,r=e.XpG(2);e.R7$(),e.FS9("alt",null==s.producto?null:s.producto.nombre),e.Y8G("src",r.getImageUrl(null==s.producto?null:s.producto.imagen[0]),e.B4B),e.R7$(3),e.JRh(null==s.producto?null:s.producto.nombre),e.R7$(2),e.SpI("Platillos: ",s.cantidadProducto,""),e.R7$(2),e.SpI("Precio unitario: $",null==s.producto?null:s.producto.precio.$numberDecimal,"")}}function P(t,a){if(1&t&&(e.j41(0,"div",9)(1,"div",10)(2,"h3",11),e.EFF(3),e.nI1(4,"date"),e.k0s(),e.j41(5,"span",12),e.EFF(6),e.k0s()(),e.j41(7,"div",13),e.DNE(8,O,9,5,"div",14),e.k0s(),e.j41(9,"div",15)(10,"p",16),e.EFF(11),e.k0s()()()),2&t){const s=a.$implicit,r=e.XpG();e.R7$(3),e.SpI(" ",e.i5U(4,4,s.createdAt,"dd/MM/yy"),""),e.R7$(3),e.JRh(r.obtenerEstado(s.estadoOrden)),e.R7$(2),e.Y8G("ngForOf",r.ordenes[s._id]),e.R7$(3),e.SpI("Total: $",s.precioTotal.$numberDecimal," (30 de env\xedo)")}}const $=[{path:"",component:(()=>{var t;class a{constructor(r){this.pedidosService=r,this.ordenes1=[],this.detalleOrdenes=[],this.ordenes={}}ngOnInit(){return(0,c.A)(function*(){})()}ionViewWillEnter(){var r=this;return(0,c.A)(function*(){try{(yield r.pedidosService.obtenerOrdenes()).subscribe(n=>{r.ordenes1=n,console.log("\xd3rdenes obtenidas:",r.ordenes1),r.cargarDetallesOrdenes()},n=>{console.error("Error al obtener las \xf3rdenes:",n)})}catch(o){console.error("Error en la carga inicial:",o)}})()}cargarDetallesOrdenes(){var r=this;return(0,c.A)(function*(){try{(yield r.pedidosService.obtenerDetalleOrdenes()).subscribe(n=>{r.detalleOrdenes=n.filter(i=>r.ordenes1.some(u=>u._id===i.idOrden)),r.organizarDetallesPorOrden(),r.obtenerEstadosOrdenes(),r.obtenerDetallesProducto()},n=>{console.error("Error al obtener los detalles de las \xf3rdenes:",n)})}catch(o){console.error("Error al cargar detalles de \xf3rdenes:",o)}})()}organizarDetallesPorOrden(){this.ordenes={},this.detalleOrdenes.forEach(r=>{this.ordenes[r.idOrden]||(this.ordenes[r.idOrden]=[]),this.ordenes[r.idOrden].push(r)}),Object.keys(this.ordenes).forEach(r=>{this.ordenes[r]=this.ordenes[r].reverse()}),console.log("Detalles de \xf3rdenes organizados por orden:",this.ordenes)}obtenerEstadosOrdenes(){Object.keys(this.ordenes).forEach(o=>{this.pedidosService.obtenerInfoDeOrdenPorId(o).subscribe(n=>{this.ordenes[o].forEach(i=>{i.estadoOrden=n.estadoOrden,i.fechaPedido=n.createdAt,i.idRestaurante=n.idRestaurante,this.obtenerInformacionRestaurante(i)})},n=>{console.error(`Error al obtener la informaci\xf3n de la orden con ID ${o}:`,n)})})}obtenerInformacionRestaurante(r){const o=r.idRestaurante;console.log("Restaurante ID:",o),this.pedidosService.obtenerRestaurante(o).subscribe(n=>{r.nombreRestaurante=n.nombreRestaurante},n=>{console.error("Error al obtener la informaci\xf3n del restaurante:",n)})}obtenerDetallesProducto(){var r=this;return(0,c.A)(function*(){const o=r.detalleOrdenes.map(n=>n.idProducto);r.pedidosService.obtenerInfoDeProductosPorIds(o).subscribe(n=>{n.forEach(i=>{r.detalleOrdenes.forEach(u=>{u.idProducto===i._id&&(u.producto=i)})}),console.log("Detalles de \xf3rdenes con informaci\xf3n de productos:",r.detalleOrdenes)},n=>{console.error("Error al obtener la informaci\xf3n de los productos:",n)})})()}getImageUrl(r){return`https://quickdinehub-back1.onrender.com/${r}`}obtenerEstado(r){switch(r){case 0:case 3:return"En espera de ser aceptado";case 1:return"Orden rechazada";case 2:return"\xbfDesea continuar con la compra?";case 4:return"En preparaci\xf3n";case 5:return"Esperando repartidor";case 6:return"Sali\xf3 de cocina, en camino";case 7:return"Confirmar entrega";case 8:return"Pedido cancelado";case 9:return"Entregado";default:return"Cargando estado"}}}return(t=a).\u0275fac=function(r){return new(r||t)(e.rXU(x))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-tab3"]],decls:13,vars:2,consts:[[3,"fullscreen"],[1,"flex","items-center","space-x-4","p-2","sm:p-4","md:p-6"],["src","assets/icon/logo-empresa.png","alt","Foto de perfil",1,"w-[3.5rem]","h-[3.5rem]","sm:w-[4.5rem]","sm:h-[4.5rem]","md:w-[5.5rem]","md:h-[5.5rem]","rounded-full"],[1,"text-md","sm:text-lg","md:text-xl","font-semibold","text-gray-900"],[1,"px-4","py-2","sm:px-6","md:px-8","text-center"],[1,"text-xl","sm:text-2xl","md:text-3xl","font-bold","text-gray-900"],[1,"font-bold",2,"color","#ff8633"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","gap-4","p-4"],["class","bg-white rounded-lg shadow-md p-4",4,"ngFor","ngForOf"],[1,"bg-white","rounded-lg","shadow-md","p-4"],[1,"flex","justify-between","items-center"],[1,"text-sm","md:text-md","font-semibold","text-gray-900"],[1,"text-sm","md:text-md","font-semibold","text-[#ff8633]"],[1,"mt-4","space-y-4"],["class","flex space-x-4 items-center",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","mt-4"],[1,"text-sm","sm:text-md","font-bold"],[1,"flex","space-x-4","items-center"],[1,"w-12","h-12","sm:w-16","sm:h-16","lg:w-20","lg:h-20","rounded-lg","object-cover",3,"src","alt"],[1,"text-sm","sm:text-md","font-semibold","text-gray-800"],[1,"text-xs","sm:text-sm","text-gray-700"]],template:function(r,o){1&r&&(e.j41(0,"ion-content",0)(1,"div",1),e.nrm(2,"img",2),e.j41(3,"div")(4,"h4",3),e.EFF(5,"QuickDineHub"),e.k0s()()(),e.j41(6,"div",4)(7,"h1",5),e.EFF(8," Mis "),e.j41(9,"span",6),e.EFF(10,"pedidos"),e.k0s()()(),e.j41(11,"div",7),e.DNE(12,P,12,7,"div",8),e.k0s()()),2&r&&(e.Y8G("fullscreen",!0),e.R7$(12),e.Y8G("ngForOf",o.ordenes1))},dependencies:[g.W9,m.Sq,m.vh]}),a})()}];let E=(()=>{var t;class a{}return(t=a).\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[f.iI.forChild($),f.iI]}),a})(),y=(()=>{var t;class a{}return(t=a).\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[g.bv,m.MD,b.YN,v.S,E]}),a})()}}]);